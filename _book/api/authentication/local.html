
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Local Â· FeathersJS</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-feathers-versions/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-advanced-emoji/emoji-website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-codetabs/codetabs.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../../styles/website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="jwt.html" />
    
    
    <link rel="prev" href="client.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../guides/readme.html">
            
                <a href="../../guides/readme.html">
            
                    
                    Guides
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../../guides/basics/readme.html">
            
                <a href="../../guides/basics/readme.html">
            
                    
                    The Basics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="../../guides/basics/setup.html">
            
                <a href="../../guides/basics/setup.html">
            
                    
                    Setting up
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="../../guides/basics/starting.html">
            
                <a href="../../guides/basics/starting.html">
            
                    
                    Getting started
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.3" data-path="../../guides/basics/services.html">
            
                <a href="../../guides/basics/services.html">
            
                    
                    Services
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.4" data-path="../../guides/basics/hooks.html">
            
                <a href="../../guides/basics/hooks.html">
            
                    
                    Hooks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.5" data-path="../../guides/basics/rest.html">
            
                <a href="../../guides/basics/rest.html">
            
                    
                    REST APIs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.6" data-path="../../guides/basics/databases.html">
            
                <a href="../../guides/basics/databases.html">
            
                    
                    Databases
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.7" data-path="../../guides/basics/real-time.html">
            
                <a href="../../guides/basics/real-time.html">
            
                    
                    Real-time APIs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.8" data-path="../../guides/basics/clients.html">
            
                <a href="../../guides/basics/clients.html">
            
                    
                    Clients
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.9" data-path="../../guides/basics/generator.html">
            
                <a href="../../guides/basics/generator.html">
            
                    
                    The generator (CLI)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../../guides/chat/readme.html">
            
                <a href="../../guides/chat/readme.html">
            
                    
                    A Chat Application
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="../../guides/chat/creating.html">
            
                <a href="../../guides/chat/creating.html">
            
                    
                    Creating the application
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="../../guides/chat/service.html">
            
                <a href="../../guides/chat/service.html">
            
                    
                    Generating a service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="../../guides/chat/authentication.html">
            
                <a href="../../guides/chat/authentication.html">
            
                    
                    Adding authentication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.4" data-path="../../guides/chat/processing.html">
            
                <a href="../../guides/chat/processing.html">
            
                    
                    Processing data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.5" data-path="../../guides/chat/frontend.html">
            
                <a href="../../guides/chat/frontend.html">
            
                    
                    Building a frontend
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.6" data-path="../../guides/chat/testing.html">
            
                <a href="../../guides/chat/testing.html">
            
                    
                    Writing tests
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../../guides/frameworks/readme.html">
            
                <a href="../../guides/frameworks/readme.html">
            
                    
                    Frameworks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../../guides/auth/readme.html">
            
                <a href="../../guides/auth/readme.html">
            
                    
                    Authentication
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="../../guides/auth/how-jwt-works.html">
            
                <a href="../../guides/auth/how-jwt-works.html">
            
                    
                    How JWT works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2" data-path="../../guides/auth/recipe.express-middleware.html">
            
                <a href="../../guides/auth/recipe.express-middleware.html">
            
                    
                    Recipe: Express middleware (SSR)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.3" data-path="../../guides/auth/recipe.customize-response.html">
            
                <a href="../../guides/auth/recipe.customize-response.html">
            
                    
                    Recipe: Custom Login Response
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.4" data-path="../../guides/auth/recipe.customize-jwt-payload.html">
            
                <a href="../../guides/auth/recipe.customize-jwt-payload.html">
            
                    
                    Recipe: Custom JWT Payload
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.5" data-path="../../guides/auth/recipe.mixed-auth.html">
            
                <a href="../../guides/auth/recipe.mixed-auth.html">
            
                    
                    Recipe: Mixed Auth Endpoints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.6" data-path="../../guides/auth/recipe.oauth-basic.html">
            
                <a href="../../guides/auth/recipe.oauth-basic.html">
            
                    
                    Recipe: Basic OAuth
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.7" data-path="../../guides/auth/recipe.custom-auth-strategy.html">
            
                <a href="../../guides/auth/recipe.custom-auth-strategy.html">
            
                    
                    Recipe: Custom Auth Strategies
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../../guides/advanced/readme.html">
            
                <a href="../../guides/advanced/readme.html">
            
                    
                    Advanced Topics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.5.1" data-path="../../guides/advanced/file-uploading.html">
            
                <a href="../../guides/advanced/file-uploading.html">
            
                    
                    Uploading files
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.2" data-path="../../guides/advanced/using-a-view-engine.html">
            
                <a href="../../guides/advanced/using-a-view-engine.html">
            
                    
                    Using a view engine
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.3" data-path="../../guides/advanced/scaling.html">
            
                <a href="../../guides/advanced/scaling.html">
            
                    
                    Scaling
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.4" data-path="../../guides/advanced/creating-a-plugin.html">
            
                <a href="../../guides/advanced/creating-a-plugin.html">
            
                    
                    Creating a plugin
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../readme.html">
            
                <a href="../readme.html">
            
                    
                    API
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" >
            
                <span>
            
                    
                    Core
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../application.html">
            
                <a href="../application.html">
            
                    
                    Application
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../services.html">
            
                <a href="../services.html">
            
                    
                    Services
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="../hooks.html">
            
                <a href="../hooks.html">
            
                    
                    Hooks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.4" data-path="../events.html">
            
                <a href="../events.html">
            
                    
                    Events
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.5" data-path="../channels.html">
            
                <a href="../channels.html">
            
                    
                    Channels
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.6" data-path="../errors.html">
            
                <a href="../errors.html">
            
                    
                    Errors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.7" data-path="../configuration.html">
            
                <a href="../configuration.html">
            
                    
                    Configuration
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" >
            
                <span>
            
                    
                    Transports
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../express.html">
            
                <a href="../express.html">
            
                    
                    Express
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../socketio.html">
            
                <a href="../socketio.html">
            
                    
                    Socket.io
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="../primus.html">
            
                <a href="../primus.html">
            
                    
                    Primus
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" >
            
                <span>
            
                    
                    Client
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="../client.html">
            
                <a href="../client.html">
            
                    
                    Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="../client/rest.html">
            
                <a href="../client/rest.html">
            
                    
                    REST
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="../client/socketio.html">
            
                <a href="../client/socketio.html">
            
                    
                    Socket.io
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.4" data-path="../client/primus.html">
            
                <a href="../client/primus.html">
            
                    
                    Primus
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" >
            
                <span>
            
                    
                    Authentication
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="server.html">
            
                <a href="server.html">
            
                    
                    Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.2" data-path="client.html">
            
                <a href="client.html">
            
                    
                    Client
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.4.3" data-path="local.html">
            
                <a href="local.html">
            
                    
                    Local
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.4" data-path="jwt.html">
            
                <a href="jwt.html">
            
                    
                    JWT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.5" data-path="oauth1.html">
            
                <a href="oauth1.html">
            
                    
                    OAuth1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.6" data-path="oauth2.html">
            
                <a href="oauth2.html">
            
                    
                    OAuth2
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.5" >
            
                <span>
            
                    
                    Database
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.5.1" data-path="../databases/adapters.html">
            
                <a href="../databases/adapters.html">
            
                    
                    Adapters
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5.2" data-path="../databases/common.html">
            
                <a href="../databases/common.html">
            
                    
                    Common API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5.3" data-path="../databases/querying.html">
            
                <a href="../databases/querying.html">
            
                    
                    Querying
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../migrating.html">
            
                <a href="../../migrating.html">
            
                    
                    Migrating
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../SECURITY.html">
            
                <a href="../../SECURITY.html">
            
                    
                    Security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <a target="_blank" href="https://github.com/feathersjs/awesome-feathersjs">
            
                    
                    Ecosystem
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../../help/readme.html">
            
                <a href="../../help/readme.html">
            
                    
                    Help
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../../faq/readme.html">
            
                <a href="../../faq/readme.html">
            
                    
                    FAQ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../../contributing/readme.html">
            
                <a href="../../contributing/readme.html">
            
                    
                    Contributing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../../license.html">
            
                <a href="../../license.html">
            
                    
                    License
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Local</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
  
                                <h1 id="local-authentication">Local Authentication</h1>
<p><a href="https://www.npmjs.com/package/@feathersjs/authentication-local" target="_blank"><img src="https://img.shields.io/npm/v/@feathersjs/authentication-local.png?style=flat-square" alt="npm version"></a>
<a href="https://github.com/feathersjs/feathers/blob/master/packages/authentication-local/CHANGELOG.md" target="_blank"><img src="https://img.shields.io/badge/changelog-.md-blue.png?style=flat-square" alt="Changelog"></a></p>
<pre><code>$ npm install @feathersjs/authentication-local --save
</code></pre><p><a href="https://github.com/feathersjs/authentication-local" target="_blank">@feathersjs/authentication-local</a> is a server side module that wraps the <a href="https://github.com/jaredhanson/passport-local" target="_blank">passport-local</a> authentication strategy, which lets you authenticate with your Feathers application using a username and password.</p>
<p>This module contains 3 core pieces:</p>
<ol>
<li>The main initialization function</li>
<li>The <code>hashPassword</code> hook </li>
<li>The <code>Verifier</code> class</li>
</ol>
<h2 id="configuration">Configuration</h2>
<p>In most cases initializing the module is as simple as doing this:</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> feathers = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;@feathersjs/feathers&apos;</span>);
<span class="hljs-keyword">const</span> authentication = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;@feathersjs/authentication&apos;</span>);
<span class="hljs-keyword">const</span> local = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;@feathersjs/authentication-local&apos;</span>);
<span class="hljs-keyword">const</span> app = feathers();

<span class="hljs-comment">// Setup authentication</span>
app.configure(authentication(settings));
app.configure(local());

<span class="hljs-comment">// Setup a hook to only allow valid JWTs or successful </span>
<span class="hljs-comment">// local auth to authenticate and get new JWT access tokens</span>
app.service(<span class="hljs-string">&apos;authentication&apos;</span>).hooks({
  before: {
    create: [
      authentication.hooks.authenticate([<span class="hljs-string">&apos;local&apos;</span>, <span class="hljs-string">&apos;jwt&apos;</span>])
    ]
  }
});
</code></pre>
<p>This will pull from your global authentication object in your config file. It will also mix in the following defaults, which can be customized.</p>
<h2 id="options">Options</h2>
<pre><code class="lang-js">{
    name: <span class="hljs-string">&apos;local&apos;</span>, <span class="hljs-comment">// the name to use when invoking the authentication Strategy</span>
    entity: <span class="hljs-string">&apos;user&apos;</span>, <span class="hljs-comment">// the entity that you&apos;re comparing username/password against</span>
    service: <span class="hljs-string">&apos;users&apos;</span>, <span class="hljs-comment">// the service to look up the entity</span>
    usernameField: <span class="hljs-string">&apos;email&apos;</span>, <span class="hljs-comment">// key name of username field</span>
    passwordField: <span class="hljs-string">&apos;password&apos;</span>, <span class="hljs-comment">// key name of password field</span>
    entityUsernameField: <span class="hljs-string">&apos;email&apos;</span>, <span class="hljs-comment">// key name of the username field on the entity (defaults to `usernameField`) </span>
    entityPasswordField: <span class="hljs-string">&apos;password&apos;</span>, <span class="hljs-comment">// key name of the password on the entity (defaults to `passwordField`) </span>
    passReqToCallback: <span class="hljs-literal">true</span>, <span class="hljs-comment">// whether the request object should be passed to `verify`</span>
    session: <span class="hljs-literal">false</span> <span class="hljs-comment">// whether to use sessions,</span>
    Verifier: Verifier <span class="hljs-comment">// A Verifier class. Defaults to the built-in one but can be a custom one. See below for details.</span>
}
</code></pre>
<blockquote>
<p><strong>Important:</strong> When setting the <code>usernameField</code> to <code>username</code> in the <a href="../configuration.html">configuration</a> the value <em>must</em> be escaped as <code>\\username</code> otherwise it will use the value of the <code>username</code> environment variable on Windows systems.</p>
</blockquote>
<h2 id="hooks">hooks</h2>
<h3 id="hashpassword">hashPassword</h3>
<p>This hook is used to hash plain text passwords before they are saved to the database. It uses the bcrypt algorithm by default but can be customized by passing your own <code>options.hash</code> function.</p>
<blockquote>
<p><strong>Important:</strong> <code>@feathersjs/authentication-local</code> does not allow to store clear text passwords. This means the <code>hashPassword</code> hook <strong>must</strong> be used when using the <a href="#verifier">standard verifier</a>.</p>
</blockquote>
<p>Available options are</p>
<ul>
<li><code>passwordField</code> (default: <code>&apos;password&apos;</code>) - key name of password field to look on context.data</li>
<li><code>hash</code> (default: bcrypt hash function) - Takes in a password and returns a hash.</li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> local = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;@feathersjs/authentication-local&apos;</span>);

app.service(<span class="hljs-string">&apos;users&apos;</span>).hooks({
  before: {
    create: [
      local.hooks.hashPassword()
    ]
  }
});
</code></pre>
<h3 id="protect">protect</h3>
<p>The protect hook makes sure that protected fields don&apos;t get sent to a client.</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> local = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;@feathersjs/authentication-local&apos;</span>);

app.service(<span class="hljs-string">&apos;users&apos;</span>).hooks({
  after: {
    create: [
      local.hooks.protect(<span class="hljs-string">&apos;password&apos;</span>)
    ]
  }
});
</code></pre>
<h2 id="verifier">Verifier</h2>
<p>This is the verification class that does the actual username and password verification by looking up the entity (normally a <code>user</code>) on a given service by the <code>usernameField</code> and compares the hashed password using bcrypt. It has the following methods that can all be overridden. All methods return a promise except <code>verify</code>, which has the exact same signature as <a href="https://github.com/jaredhanson/passport-local" target="_blank">passport-local</a>.</p>
<pre><code class="lang-js">{
    <span class="hljs-keyword">constructor</span>(app, options) // the class <span class="hljs-keyword">constructor</span>
    _comparePassword(entity, password) // compares password using bcrypt
    _normalizeResult(result) // normalizes result from service to account for pagination
    verify(req, username, password, done) // queries the service and calls the other internal functions.
}
</code></pre>
<p>The <code>Verifier</code> class can be extended so that you customize it&apos;s behavior without having to rewrite and test a totally custom local Passport implementation. Although that is always an option if you don&apos;t want use this plugin.</p>
<p>An example of customizing the Verifier:</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> local, { Verifier } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@feathersjs/authentication-local&apos;</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomVerifier</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Verifier</span> </span>{
  <span class="hljs-comment">// The verify function has the exact same inputs and </span>
  <span class="hljs-comment">// return values as a vanilla passport strategy</span>
  verify(req, username, password, done) {
    <span class="hljs-comment">// do your custom stuff. You can call internal Verifier methods</span>
    <span class="hljs-comment">// and reference this.app and this.options. This method must be implemented.</span>

    <span class="hljs-comment">// the &apos;user&apos; variable can be any truthy value</span>
    <span class="hljs-comment">// the &apos;payload&apos; is the payload for the JWT access token that is generated after successful authentication</span>
    done(<span class="hljs-literal">null</span>, user, payload);
  }
}

app.configure(local({ Verifier: CustomVerifier }));
</code></pre>
<h2 id="client-usage">Client Usage</h2>
<h3 id="authentication-client">authentication-client</h3>
<p>When this module is registered server side, using the default config values this is how you can authenticate using <a href="client.html">@feathersjs/authentication-client</a>:</p>
<pre><code class="lang-js">app.authenticate({
  strategy: <span class="hljs-string">&apos;local&apos;</span>,
  email: <span class="hljs-string">&apos;your email&apos;</span>,
  password: <span class="hljs-string">&apos;your password&apos;</span>
}).then(response =&gt; {
  <span class="hljs-comment">// You are now authenticated</span>
});
</code></pre>
<h3 id="http-request">HTTP Request</h3>
<p>If you are not using the <code>@feathersjs/authentication-client</code> and you have registered this module server side, make a <code>POST</code> request to <code>/authentication</code> with the following payload:</p>
<pre><code class="lang-json"><span class="hljs-comment">// POST /authentication the Content-Type header set to application/json</span>
{
  <span class="hljs-string">&quot;strategy&quot;</span>: <span class="hljs-string">&quot;local&quot;</span>,
  <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;your email&quot;</span>,
  <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;your password&quot;</span>
}
</code></pre>
<p>Here is what that looks like with curl:</p>
<pre><code class="lang-bash">curl -H <span class="hljs-string">&quot;Content-Type: application/json&quot;</span> -X POST <span class="hljs-_">-d</span> <span class="hljs-string">&apos;{&quot;strategy&quot;:&quot;local&quot;,&quot;email&quot;:&quot;your email&quot;,&quot;password&quot;:&quot;your password&quot;}&apos;</span> http://localhost:3030/authentication
</code></pre>
<h3 id="sockets">Sockets</h3>
<p>Authenticating using a local strategy via sockets is done by emitting the following message:</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> io = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;socket.io-client&apos;</span>);
<span class="hljs-keyword">const</span> socket = io(<span class="hljs-string">&apos;http://localhost:3030&apos;</span>);

socket.emit(<span class="hljs-string">&apos;authenticate&apos;</span>, {
  strategy: <span class="hljs-string">&apos;local&apos;</span>,
  email: <span class="hljs-string">&apos;your email&apos;</span>,
  password: <span class="hljs-string">&apos;your password&apos;</span>
}, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">message, data</span>) </span>{
  <span class="hljs-built_in">console</span>.log(message); <span class="hljs-comment">// message will be null</span>
  <span class="hljs-built_in">console</span>.log(data); <span class="hljs-comment">// data will be {&quot;accessToken&quot;: &quot;your token&quot;}</span>
  <span class="hljs-comment">// You can now send authenticated messages to the server</span>
});
</code></pre>

                                
  <blockquote>
    <p>
        Is anything wrong, unclear, missing?
        <a target="_blank" href="https://github.com/feathersjs/docs/issues/new?title=Comment: Local (api/authentication/local.md)">Leave a comment</a> or
        <a target="_blank" href="https://github.com/feathersjs/docs/edit/master/api/authentication/local.md">edit this page</a>.
    </p>
  </blockquote>

                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="client.html" class="navigation navigation-prev " aria-label="Previous page: Client">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="jwt.html" class="navigation navigation-next " aria-label="Next page: JWT">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Local","level":"1.3.4.3","depth":3,"next":{"title":"JWT","level":"1.3.4.4","depth":3,"path":"api/authentication/jwt.md","ref":"api/authentication/jwt.md","articles":[]},"previous":{"title":"Client","level":"1.3.4.2","depth":3,"path":"api/authentication/client.md","ref":"api/authentication/client.md","articles":[]},"dir":"ltr"},"config":{"plugins":["feathers-collapsible-menu","heading-anchors","include-codeblock","edit-link","feathers-versions","advanced-emoji","codetabs","livereload"],"styles":{"website":"styles/website.css"},"pluginsConfig":{"livereload":{},"search":{},"codetabs":{},"lunr":{"maxIndexSize":1000000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"heading-anchors":{},"highlight":{},"feathers-versions":{},"versions":{"gitbookConfigURL":"https://rawgit.com/feathersjs/feathers-docs/master/book.json","options":[{"value":"https://crow.docs.feathersjs.com","text":"Next version - Crow"},{"value":"https://docs.feathersjs.com","text":"Latest Stable - Buzzard"},{"value":"https://auk.docs.feathersjs.com","text":"Previous release - Auk"},{"value":"https://legacy.docs.feathersjs.com","text":"Legacy"}]},"advanced-emoji":{"embedEmojis":false},"include-codeblock":{"check":false,"edit":false,"fixlang":false,"lang":"","template":"default","theme":"chrome","unindent":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"edit-link":{"label":"Edit This Page","base":"https://github.com/feathersjs/docs/edit/master","placement":"left"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"feathers-collapsible-menu":{},"menu":{"deep":true}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"FeathersJS","gitbook":"*"},"file":{"path":"api/authentication/local.md","mtime":"2018-10-21T12:11:38.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-10-21T18:29:49.010Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-feathers-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/1.2.1/anchor.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-heading-anchors/anchor-style.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-feathers-versions/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-codetabs/codetabs.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

